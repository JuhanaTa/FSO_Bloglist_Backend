(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{59:function(e,t,n){e.exports=n(89)},68:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),l=n(18),u=n.n(l),o=n(8),s=(n(68),n(4)),i=n.n(s),m=n(6),d=n(39),p=n(58),f=n(15),v=n.n(f),E=null,b={getAll:function(){return v.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(m.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:E}},e.next=3,v.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){E="bearer ".concat(e)},update:function(e,t){var n={headers:{Authorization:E}};return v.a.put("".concat("/api/blogs","/").concat(e),t,n).then((function(e){return e.data}))},remove:function(){var e=Object(m.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:E}},e.next=3,v.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.status);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(e){return console.log("reducer used"),function(){var t=Object(m.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.create(e);case 2:a=t.sent,n({type:"ADDNEW",data:{title:a.title,author:a.author,url:a.url,id:a.id,likes:0}});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},h=function(e){return function(){var t=Object(m.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.remove(e);case 2:return t.next=4,b.getAll();case 4:a=t.sent,n({type:"DELETE_BLOG",data:a});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},w=function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(a){var r,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.update(e,t);case 2:return r=n.sent,n.next=5,b.getAll();case 5:c=n.sent,console.log("liked blog: "+r.id),a({type:"LIKE",data:{id:e,blogs:c}});case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},y=function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(a){var r,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.update(e,t);case 2:return r=n.sent,n.next=5,b.getAll();case 5:c=n.sent,console.log("commented blog: "+r.id),a({type:"COMMENT",data:{id:e,blogs:c}});case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADDNEW":return e.concat(t.data);case"INIT_BLOGS":case"DELETE_BLOG":return t.data;case"NEW_BLOG":return[].concat(Object(p.a)(e),[t.data]);case"LIKE":var n=t.data.id,a=e.find((function(e){return e.id===n})),r=Object(d.a)({},a),c=e.map((function(e){return e.id!==n?e:r}));return console.log("return "+c),t.data.blogs;case"COMMENT":var l=t.data.id,u=e.find((function(e){return e.id===l})),o=Object(d.a)({},u),s=e.map((function(e){return e.id!==l?e:o}));return console.log("return "+s),t.data.blogs;default:return e}},O=[],x=function(e,t,n){return window.clearTimeout(a),n*=1e3,function(){var r=Object(m.a)(i.a.mark((function r(c){return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c({type:"CREATE_NOTIFICATION",data:{content:e,type:t}}),a=setTimeout((function(){c({type:"SET_HIDDEN",data:{content:e=""}})}),n);case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_NOTIFICATION":case"SET_HIDDEN":return t.data;default:return e}},C=function(){return v.a.get("/api/users").then((function(e){return e.data}))},B=function(){return function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:n=e.sent,t({type:"GET_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return t.data;default:return e}},N=n(93),I=n(91),L=function(){var e=Object(o.c)(),t=function(){var t=Object(m.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={title:n.target.Title.value,author:n.target.Author.value,url:n.target.Url.value},n.target.Title.value="",n.target.Author.value="",n.target.Url.value="",t.prev=5,t.next=8,e(g(a));case 8:return t.next=10,e(B());case 10:e(x("new blog '".concat(a.title,"' added"),"success",5)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),e(x("blog was not added","error",5));case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("h2",null,"create new"),c.a.createElement(N.a,{onSubmit:t},c.a.createElement(N.a.Group,null,c.a.createElement(N.a.Label,null,"title:"),c.a.createElement(N.a.Control,{id:"title",type:"text",name:"Title"}),c.a.createElement(N.a.Label,null,"author:"),c.a.createElement(N.a.Control,{id:"author",type:"text",name:"Author"}),c.a.createElement(N.a.Label,null,"url:"),c.a.createElement(N.a.Control,{id:"url",type:"text",name:"Url"}),c.a.createElement(I.a,{variant:"primary",type:"submit",id:"createBlogBtn"},"create"))))},S=n(30),U=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(S.a)(n,2),l=a[0],u=a[1],o={display:l?"none":""},s={display:l?"":"none"},i=function(){u(!l)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),c.a.createElement("div",null,c.a.createElement("div",{style:o},c.a.createElement(I.a,{onClick:i,id:"revealBtn"},e.buttonLabel)),c.a.createElement("div",{style:s},e.children,c.a.createElement(I.a,{onClick:i,id:"hideBtn"},"cancel")))}));U.displayName="Togglable";var A=U,D={login:function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},R=function(e){var t=e.username,n=e.password;return function(){var e=Object(m.a)(i.a.mark((function e(a){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.login({username:t,password:n});case 2:r=e.sent,window.localStorage.setItem("blogUser",JSON.stringify(r)),a({type:"LOGIN",data:{token:r.token,username:r.username,name:r.name}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},G=function(e){var t=e.username,n=e.name,a=e.password;return function(){var e=Object(m.a)(i.a.mark((function e(r){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.register({username:t,name:n,password:a});case 2:c=e.sent,r({type:"REGISTER",data:{username:c.username,name:c.name,password:c.password}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_=function(){var e=window.localStorage.getItem("blogUser"),t=JSON.parse(e);return b.setToken(t.token),function(){var e=Object(m.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"INIT_USER",data:{token:t.token,username:t.username,name:t.name}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":case"CLEAR":case"INIT_USER":case"REGISTER":return t.data;default:return e}},H=function(e){var t=e.addUser;return c.a.createElement("div",null,c.a.createElement("h2",null,"Please login"),c.a.createElement(N.a,{onSubmit:t},c.a.createElement(N.a.Group,null,c.a.createElement(N.a.Label,null,"username:"),c.a.createElement(N.a.Control,{id:"username",type:"text",name:"Username"}),c.a.createElement(N.a.Label,null,"password:"),c.a.createElement(N.a.Control,{id:"password",type:"password",name:"Password"}),c.a.createElement(I.a,{variant:"primary",type:"submit",id:"loginBtn"},"login"))))},M=function(e){var t=e.createUser;return c.a.createElement("div",null,c.a.createElement("h2",null,"Create a new account"),c.a.createElement(N.a,{onSubmit:t},c.a.createElement(N.a.Group,null,c.a.createElement(N.a.Label,null,"username:"),c.a.createElement(N.a.Control,{id:"username",type:"text",name:"Username"}),c.a.createElement(N.a.Label,null,"name:"),c.a.createElement(N.a.Control,{id:"name",type:"text",name:"Name"}),c.a.createElement(N.a.Label,null,"password:"),c.a.createElement(N.a.Control,{id:"password",type:"password",name:"Password"}),c.a.createElement(I.a,{variant:"primary",type:"submit",id:"loginBtn"},"register"))))},F=function(){var e=Object(o.c)(),t=Object(r.useState)(!1),n=Object(S.a)(t,2),a=n[0],l=n[1],u=function(){l(!0!==a)},s=function(){var t=Object(m.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={username:n.target.Username.value,password:n.target.Password.value},n.target.Username.value="",n.target.Password.value="",t.prev=4,t.next=7,e(R(a));case 7:return t.next=9,e(_());case 9:e(x("login success","success",5)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),e(x("wrong username or password","error",5));case 15:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=Object(m.a)(i.a.mark((function t(n){var a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={username:n.target.Username.value,name:n.target.Username.value,password:n.target.Password.value},r={username:n.target.Username.value,password:n.target.Password.value},console.log("inside register"),t.prev=4,t.next=7,e(G(a));case 7:return t.next=9,e(R(r));case 9:e(x("Account created","success",5)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),e(x("account not created","error",5));case 15:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}();return c.a.createElement("div",null,!1===a?c.a.createElement("div",null,c.a.createElement(H,{addUser:s}),c.a.createElement("h5",null,"No account yet?"),c.a.createElement(I.a,{onClick:u,id:"showRegisterBtn"},"Clich here to create one")):c.a.createElement("div",null,c.a.createElement(M,{createUser:d}),c.a.createElement(I.a,{onClick:u,id:"showRegisterBtn"},"Back to login")))},J=Object(o.b)((function(e){return{notification:e.notification}}))((function(e){return""===e.notification.content?null:"success"===e.notification.type?c.a.createElement("div",{className:"success"},e.notification.content):"error"===e.notification.type?c.a.createElement("div",{className:"error"},e.notification.content):null})),W=n(16),z=function(e){var t=e.id,n=e.blog,a=Object(o.c)();console.log("blog id"+t);var r=function(){var e=Object(m.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("id of blog: "+n.id),e.prev=2,e.next=5,a(h(n.id));case 5:return e.next=7,a(B());case 7:a(x("blog removed","success",5)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),a(x("You cant remove that","error",5));case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement(W.b,{key:n.id,to:"/blogs/".concat(n.id)},n.title)),c.a.createElement("td",null,c.a.createElement(I.a,{onClick:r,id:"removeBtn"},"delete")))},K=n(7),V=n(96),Y=function(e){var t=e.blog;return c.a.createElement("li",null,t.title)},q=function(e){var t=e.oneUser,n=e.user;return t?0===t.blogs.length?c.a.createElement("div",null,void 0===n.name?c.a.createElement(K.a,{to:"/"}):c.a.createElement("div",null,c.a.createElement("h3",null,"Blogs from ",t.username),c.a.createElement("p",null,"Hmm... it seems like there is no blogs from ",t.username))):c.a.createElement("div",null,void 0===n.name?c.a.createElement(K.a,{to:"/"}):c.a.createElement("div",null,c.a.createElement(J,null),c.a.createElement("h3",null,"Blogs from ",t.username),c.a.createElement(V.a,{style:{width:"30rem"}},c.a.createElement(V.a.Body,null,c.a.createElement("ul",null,t.blogs.map((function(e){return c.a.createElement(Y,{key:e.id,blog:e})}))))))):null},Q=function(e){var t=e.comments,n=1;return t?c.a.createElement("div",null,c.a.createElement("ul",null,t.map((function(e){return c.a.createElement("li",{key:n++},e)})))):c.a.createElement("div",null,"No comments in this blog. Be first one to comment")},X=function(e){var t=e.blog,n=Object(o.c)();if(!t)return null;var a=function(){var e=Object(m.a)(i.a.mark((function e(a){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),r={url:t.url,title:t.title,likes:t.likes+1,author:t.author,comments:t.comments},e.prev=2,e.next=5,n(w(t.id,r));case 5:n(x("you liked '".concat(r.title,"'"),"success",5)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n(x("blog was not liked (may be already removed)","error",5));case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Object(m.a)(i.a.mark((function e(a){var r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),r="",t.comments?(t.comments.push(a.target.Comment.value),r=t.comments):r=a.target.Comment.value,a.target.Comment.value="",c={url:t.url,title:t.title,likes:t.likes,author:t.author,comments:r},e.prev=5,e.next=8,n(y(t.id,c));case 8:n(x("comment added","success",5)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),n(x("something went wrong","error",5));case 14:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("h1",null,t.title),c.a.createElement("a",{href:"https://".concat(t.url)},t.url),c.a.createElement("p",null,"Blog added by ",t.author),c.a.createElement("h4",null,"likes: ",t.likes," ",c.a.createElement(I.a,{onClick:a,id:"likeBtn"},"like")),c.a.createElement(V.a,{style:{width:"30rem"}},c.a.createElement(V.a.Body,null,c.a.createElement(N.a,{onSubmit:r},c.a.createElement(N.a.Group,null,c.a.createElement(N.a.Label,null,"Comments "),c.a.createElement(N.a.Control,{id:"comment",type:"text",name:"Comment"}),c.a.createElement(I.a,{variant:"primary",type:"submit",id:"commentBtn"},"Create a comment"))),c.a.createElement(Q,{comments:t.comments}))))},Z=n(92),$=n(94),ee=n(95),te=function(e){var t=e.createBlogForm,n=Object(o.c)(),a=Object(o.d)((function(e){return e.login})),r=Object(o.d)((function(e){return e.users})),l=Object(o.d)((function(e){return e.blogs})),u=function(e){var t=e.handleClick,n=e.text;return c.a.createElement("button",{onClick:t},n)},s=function(){n((window.localStorage.clear(),function(){var e=Object(m.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"CLEAR",data:{}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},d=function(){var e=0;return l.sort((function(e,t){return t.likes-e.likes})),c.a.createElement("div",null,c.a.createElement(Z.a,{striped:!0},c.a.createElement("tbody",null,l.map((function(t){return c.a.createElement(z,{key:t.id,id:e++,blog:t})})))))},p=Object(K.g)("/users/:id"),f=p?r.find((function(e){return e.id===p.params.id})):null,v=Object(K.g)("/blogs/:id"),E=v?l.find((function(e){return e.id===v.params.id})):null;return c.a.createElement("div",null,c.a.createElement((function(){return void 0===a.name?c.a.createElement("div",null):c.a.createElement($.a,{bg:"primary",variant:"dark"},c.a.createElement(ee.a,null,c.a.createElement($.a.Text,null,c.a.createElement(W.c,{to:"/"},"Home"),"     ",c.a.createElement(W.c,{to:"/users"},"Users"),"   ",c.a.createElement(u,{className:"ml-auto",handleClick:s,text:"logout"})),c.a.createElement($.a.Brand,{className:"ml-auto"},"Logged in as ",a.name)))}),null),c.a.createElement(J,null),c.a.createElement(K.d,null,c.a.createElement(K.b,{path:"/blogs/:id"},void 0===a.name?c.a.createElement(K.a,{to:"/"}):c.a.createElement("div",null,c.a.createElement(X,{blog:E}))),c.a.createElement(K.b,{path:"/users/:id"},c.a.createElement(q,{oneUser:f,user:a})),c.a.createElement(K.b,{path:"/users"},c.a.createElement((function(){return c.a.createElement("div",null,void 0===a.name?c.a.createElement(F,null):c.a.createElement("div",null,c.a.createElement("h2",null,"Blog users"),c.a.createElement(V.a,{style:{width:"18rem"}},c.a.createElement(V.a.Body,null,c.a.createElement(Z.a,{striped:!0,bordered:!0,hover:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"User"),c.a.createElement("th",null,"blogs created"))),c.a.createElement("tbody",null,r.map((function(e){return c.a.createElement("tr",{key:e.id},c.a.createElement("td",null,c.a.createElement(W.b,{to:"/users/".concat(e.id)},e.username)),c.a.createElement("td",null,e.blogs.length))}))))))))}),null)),c.a.createElement(K.b,{path:"/"},c.a.createElement("div",null,void 0===a.name?c.a.createElement(F,null):c.a.createElement("div",{id:"mainDiv"},c.a.createElement("h2",null,"Blogs"),c.a.createElement(d,null),t())))))},ne=function(){var e=Object(o.c)();Object(r.useEffect)((function(){e(function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(r.useEffect)((function(){e(B())}),[e]),Object(r.useEffect)((function(){try{e(_())}catch(t){console.log("no user")}}),[e]);var t=Object(r.useRef)();return c.a.createElement("div",{className:"container"},c.a.createElement(W.a,null,c.a.createElement(te,{createBlogForm:function(){return c.a.createElement(A,{buttonLabel:"new blog",ref:t},c.a.createElement(L,null))}})))},ae=n(56),re=n(21),ce=n(57),le=Object(re.combineReducers)({notification:j,blogs:k,login:P,users:T}),ue=Object(re.createStore)(le,Object(ae.composeWithDevTools)(Object(re.applyMiddleware)(ce.a)));u.a.render(c.a.createElement(o.a,{store:ue},c.a.createElement(ne,null)),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.e10e00e9.chunk.js.map